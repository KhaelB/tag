!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ASPA=e():t.ASPA=e()}(this,(function(){return function(){"use strict";var t={635:function(t,e,n){n.r(e),n.d(e,{__addDisposableResource:function(){return R},__assign:function(){return i},__asyncDelegator:function(){return O},__asyncGenerator:function(){return A},__asyncValues:function(){return I},__await:function(){return P},__awaiter:function(){return h},__classPrivateFieldGet:function(){return x},__classPrivateFieldIn:function(){return N},__classPrivateFieldSet:function(){return C},__createBinding:function(){return v},__decorate:function(){return s},__disposeResources:function(){return L},__esDecorate:function(){return u},__exportStar:function(){return g},__extends:function(){return o},__generator:function(){return _},__importDefault:function(){return k},__importStar:function(){return j},__makeTemplateObject:function(){return T},__metadata:function(){return d},__param:function(){return c},__propKey:function(){return f},__read:function(){return m},__rest:function(){return a},__rewriteRelativeImportExtension:function(){return M},__runInitializers:function(){return l},__setFunctionName:function(){return p},__spread:function(){return w},__spreadArray:function(){return S},__spreadArrays:function(){return b},__values:function(){return y}});var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function s(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function c(t,e){return function(n,r){e(n,r,t)}}function u(t,e,n,r,o,i){function a(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var s,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!e&&t?r.static?t:t.prototype:null,f=e||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),p=!1,d=n.length-1;d>=0;d--){var h={};for(var _ in r)h[_]="access"===_?{}:r[_];for(var _ in r.access)h.access[_]=r.access[_];h.addInitializer=function(t){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(t||null))};var v=(0,n[d])("accessor"===c?{get:f.get,set:f.set}:f[u],h);if("accessor"===c){if(void 0===v)continue;if(null===v||"object"!=typeof v)throw new TypeError("Object expected");(s=a(v.get))&&(f.get=s),(s=a(v.set))&&(f.set=s),(s=a(v.init))&&o.unshift(s)}else(s=a(v))&&("field"===c?o.unshift(s):f[u]=s)}l&&Object.defineProperty(l,r.name,f),p=!0}function l(t,e,n){for(var r=arguments.length>2,o=0;o<e.length;o++)n=r?e[o].call(t,n):e[o].call(t);return r?n:void 0}function f(t){return"symbol"==typeof t?t:"".concat(t)}function p(t,e,n){return"symbol"==typeof e&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function d(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))}function _(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var v=Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function g(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||v(e,t,n)}function y(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function w(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}function b(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}function S(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}function P(t){return this instanceof P?(this.v=t,this):new P(t)}function A(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(t,e||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",(function(t){return function(e){return Promise.resolve(e).then(t,u)}})),r[Symbol.asyncIterator]=function(){return this},r;function a(t,e){o[t]&&(r[t]=function(e){return new Promise((function(n,r){i.push([t,e,n,r])>1||s(t,e)}))},e&&(r[t]=e(r[t])))}function s(t,e){try{(n=o[t](e)).value instanceof P?Promise.resolve(n.value.v).then(c,u):l(i[0][2],n)}catch(t){l(i[0][3],t)}var n}function c(t){s("next",t)}function u(t){s("throw",t)}function l(t,e){t(e),i.shift(),i.length&&s(i[0][0],i[0][1])}}function O(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,o){e[r]=t[r]?function(e){return(n=!n)?{value:P(t[r](e)),done:!1}:o?o(e):e}:o}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=y(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,o){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,o,(e=t[n](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},D=function(t){return D=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},D(t)};function j(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n=D(t),r=0;r<n.length;r++)"default"!==n[r]&&v(e,t,n[r]);return E(e,t),e}function k(t){return t&&t.__esModule?t:{default:t}}function x(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function C(t,e,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(t,n):o?o.value=n:e.set(t,n),n}function N(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)}function R(t,e,n){if(null!=e){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object expected.");var r,o;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(o=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");o&&(r=function(){try{o.call(this)}catch(t){return Promise.reject(t)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var U="function"==typeof SuppressedError?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function L(t){function e(e){t.error=t.hasError?new U(e,t.error,"An error was suppressed during disposal."):e,t.hasError=!0}var n,r=0;return function o(){for(;n=t.stack.pop();)try{if(!n.async&&1===r)return r=0,t.stack.push(n),Promise.resolve().then(o);if(n.dispose){var i=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(i).then(o,(function(t){return e(t),o()}))}else r|=1}catch(t){e(t)}if(1===r)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}function M(t,e){return"string"==typeof t&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(t,n,r,o,i){return n?e?".jsx":".js":!r||o&&i?r+o+"."+i.toLowerCase()+"js":t})):t}e.default={__extends:o,__assign:i,__rest:a,__decorate:s,__param:c,__esDecorate:u,__runInitializers:l,__propKey:f,__setFunctionName:p,__metadata:d,__awaiter:h,__generator:_,__createBinding:v,__exportStar:g,__values:y,__read:m,__spread:w,__spreadArrays:b,__spreadArray:S,__await:P,__asyncGenerator:A,__asyncDelegator:O,__asyncValues:I,__makeTemplateObject:T,__importStar:j,__importDefault:k,__classPrivateFieldGet:x,__classPrivateFieldSet:C,__classPrivateFieldIn:N,__addDisposableResource:R,__disposeResources:L,__rewriteRelativeImportExtension:M}},884:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.AspaTag=void 0;var r=n(635),o=function(){function t(t){this.canvas=null,this._mutationObserver=null,this._clickHandler=null,this._submitHandler=null,this.config=t,this.validateConfig(),this._cleanupOldSessions(),this.sessionData=this._restoreSessionOrInitNew();try{this.canvas=document.createElement("canvas"),this.canvas.width=100,this.canvas.height=100}catch(t){this.canvas=null,console.error("ASPA Tag: Canvas for fingerprinting could not be created.")}this._initializeGlobalAPI(),this._setupNavigationTracking(),this._setupInteractionListeners(),this._setupTriggers(),this._handleNavigation(!0)}return t.initialize=function(){window.ASPA_PERSONALIZATION&&!t.instance&&(t.instance=new t(window.ASPA_PERSONALIZATION))},t.prototype.openWhatsApp=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,o,i;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this._updateLastPageDuration(),[4,this.emitSessionEvent(t)];case 1:return e=r.sent(),n=e.message||this.config.message||"Hello!",o="https://wa.me/".concat(this.config.targetPhoneNumber,"?text=").concat(encodeURIComponent(n)),window.open(o,"_blank"),[3,3];case 2:return i=r.sent(),console.error("ASPA Tag: Error opening WhatsApp:",i),[3,3];case 3:return[2]}}))}))},t.prototype._initializeGlobalAPI=function(){var t=this;window.ASPA_openWhatsApp=function(e){return t.openWhatsApp(e)},window.ASPA_emitSessionEvent=function(e){return t.emitSessionEvent(e)},console.log("ASPA API initialized")},t.prototype.emitSessionEvent=function(t){return r.__awaiter(this,void 0,void 0,(function(){var e,n,o,i,a,s,c;return r.__generator(this,(function(u){switch(u.label){case 0:return this.sessionData.lastActivity=Date.now(),e=this.sessionData,[4,this._getFingerprint()];case 1:e.fingerprint=u.sent(),this.sessionData.cookies=this._getTrackedCookies(),this._saveSession();try{n=JSON.stringify(r.__assign(r.__assign({},this.sessionData),t?{formData:t}:{}))}catch(t){console.error("ASPA Tag: Error serializing session data:",t),n=JSON.stringify(this.sessionData)}u.label=2;case 2:return u.trys.push([2,7,,8]),"/"===(o=this.config.backendUrl).charAt(o.length-1)&&(o=o.slice(0,-1)),i="".concat(o,"/recordSession/").concat(this.config.integrationId),[4,fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0})];case 3:return(a=u.sent()).ok?[3,5]:[4,a.json().catch((function(){return null}))];case 4:throw s=u.sent(),new Error((null==s?void 0:s.message)||"HTTP error! status: ".concat(a.status));case 5:return[4,a.json()];case 6:return[2,u.sent()];case 7:return c=u.sent(),console.error("ASPA Tag: Failed to emit session event.",c),[2,{sessionId:this.sessionData.sessionId,message:"Error: Could not connect to the server.",timestamp:(new Date).toISOString()}];case 8:return[2]}}))}))},t.prototype._setupNavigationTracking=function(){var t=this,e=history.pushState,n=history.replaceState;history.pushState=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.apply(history,n),t._handleNavigation()},history.replaceState=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n.apply(history,e),t._handleNavigation()},window.addEventListener("popstate",(function(){return t._handleNavigation()})),window.addEventListener("beforeunload",(function(){t._updateLastPageDuration(),t._saveSession()}))},t.prototype._setupInteractionListeners=function(){var t=this;document.addEventListener("click",(function(e){var n=t._getCurrentPageInteractions();if(n){var r=t._generateSelector(e.target);r&&n.clicks.push({target:r,timestamp:Date.now()})}}),{capture:!0,passive:!0});var e=null;window.addEventListener("scroll",(function(){e&&window.clearTimeout(e),e=window.setTimeout((function(){var e=t._getCurrentPageInteractions();if(e){var n=document.documentElement.scrollHeight-window.innerHeight;if(!(n<=0)){var r=Math.round(window.scrollY/n*100);r>e.scrollDepth&&(e.scrollDepth=r)}}}),150)}),{capture:!0,passive:!0})},t.prototype._setupTriggers=function(){var t,e,n=this,r=this.config.triggers;if(r){var o=function(t,e){return e.some((function(e){try{return t.matches(e)||null!==t.closest(e)}catch(t){return console.warn("Invalid CSS selector: ".concat(e),t),!1}}))},i=function(t){var e;if(null===(e=r.clickSelectors)||void 0===e?void 0:e.length){var i=t.target;o(i,r.clickSelectors)&&(t.preventDefault(),t.stopPropagation(),console.debug("ASPA: Click trigger matched:",i),n.openWhatsApp())}},a=function(t){var e;if(null===(e=r.formSelectors)||void 0===e?void 0:e.length){var i=t.target,a="FORM"===i.tagName?i:i.closest("form");a&&o(a,r.formSelectors)&&(t.preventDefault(),t.stopPropagation(),console.debug("ASPA: Form submit trigger matched:",a),n.openWhatsApp())}};(null===(t=r.clickSelectors)||void 0===t?void 0:t.length)&&(console.debug("ASPA: Setting up click triggers:",r.clickSelectors),document.addEventListener("click",i,!0)),(null===(e=r.formSelectors)||void 0===e?void 0:e.length)&&(console.debug("ASPA: Setting up form submit triggers:",r.formSelectors),document.addEventListener("submit",a,!0)),this._clickHandler=i.bind(this),this._submitHandler=a.bind(this)}},t.prototype._handleNavigation=function(t){void 0===t&&(t=!1);var e=window.location.href,n=this.sessionData.navigation.history.at(-1);if(t||e!==(null==n?void 0:n.url)){this._updateLastPageDuration(),this._trackUTMParameters(),this._trackAdClickIds();var o=this._getPageMetadata();this.sessionData.navigation.currentUrl=e,this.sessionData.navigation.history.push(r.__assign({url:e,referrer:t?document.referrer:(null==n?void 0:n.url)||"",timestamp:Date.now()},o));var i=this._getSanitizedUrl(e);this.sessionData.pageInteractions[i]||(this.sessionData.pageInteractions[i]={clicks:[],scrollDepth:0}),this._saveSession()}},t.prototype._getPageMetadata=function(){var t,e,n=Array.from(document.querySelectorAll("a")).map((function(t){return t.href})).filter((function(t){return t.startsWith("http")}));return{title:document.title,h1:(null===(e=null===(t=document.querySelector("h1"))||void 0===t?void 0:t.textContent)||void 0===e?void 0:e.trim())||null,hrefs:n}},t.prototype._updateLastPageDuration=function(){var t=this.sessionData.navigation.history.at(-1);t&&!t.duration&&(t.duration=Date.now()-t.timestamp)},t.prototype._trackAdClickIds=function(){var e,n;try{var o=new URLSearchParams(window.location.search);try{for(var i=r.__values(t.AD_CLICK_IDENTIFIERS),a=i.next();!a.done;a=i.next()){var s=a.value,c=o.get(s);c&&!this.sessionData.adClickIds[s]&&(this.sessionData.adClickIds[s]=c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}catch(t){console.error("ASPA Tag: Error tracking Ad Click IDs.",t)}},t.prototype._trackUTMParameters=function(){var e,n;try{var o=new URLSearchParams(window.location.search);try{for(var i=r.__values(t.UTM_PARAMETERS),a=i.next();!a.done;a=i.next()){var s=a.value,c=o.get(s);c&&this._addUtmParameter(s,c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}catch(t){console.error("ASPA Tag: Error tracking UTM parameters.",t)}},t.prototype._addUtmParameter=function(e,n){var r=this.sessionData.navigation.utmTracking;if(!r.allUtmParameters.some((function(t){return t.name===e&&t.value===n}))){var o=t.UTM_CATEGORIES[e]||"other",i={name:e,value:n,timestamp:Date.now(),category:o};if(r.allUtmParameters.push(i),"other"!==o){var a="".concat(o,"s"),s=r.categorized[a];s&&!s.some((function(t){return t.value===n}))&&s.push(i)}}r.latestValues[e]=n},t.prototype._getCurrentPageInteractions=function(){var t=this._getSanitizedUrl(this.sessionData.navigation.currentUrl);return this.sessionData.pageInteractions[t]||null},t.prototype._generateSelector=function(t){if(!t||t.matches("input[type='password'], input[type='email']")||t.closest("[data-aspa-ignore]"))return null;if(t.id)return"#".concat(t.id);for(var e=[],n=t;n&&n.nodeType===Node.ELEMENT_NODE;){var r=n.nodeName.toLowerCase();if(n.className&&"string"==typeof n.className){var o=n.className.split(" ").filter((function(t){return t&&!/^[0-9]/.test(t)})).join(".");o&&(r+=".".concat(o))}e.unshift(r),n=n.parentElement}return e.slice(0,5).join(" > ")},t.prototype._getFingerprint=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return t={userAgent:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenResolution:"".concat(window.screen.width,"x").concat(window.screen.height)},[4,this._generateCanvasFingerprint()];case 1:return[2,(t.canvasFingerprint=e.sent(),t)]}}))}))},t.prototype._generateCanvasFingerprint=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,e,n,o;return r.__generator(this,(function(r){if(!this.canvas)return[2,""];if(!(t=this.canvas.getContext("2d")))return[2,""];for(t.fillStyle="#25D366",t.font="14px Arial",t.textBaseline="top",t.fillText("ASPA_Tracker_Canvas",10,10),e=t.getImageData(0,0,100,100).data,n=0,o=0;o<e.length;o++)n=(n<<5)-n+e[o],n|=0;return[2,n.toString()]}))}))},t.prototype._getTrackedCookies=function(){var t=this.config.cookieAllowlist||["_ga","_gid","gclid","fbclid"],e={};try{document.cookie.split(";").forEach((function(n){var o=r.__read(n.trim().split("="),2),i=o[0],a=o[1];i&&a&&t.includes(i)&&(e[i]=decodeURIComponent(a))}))}catch(t){}return e},t.prototype._saveSession=function(){try{localStorage.setItem("aspa_session_".concat(this.config.integrationId),JSON.stringify(this.sessionData))}catch(t){console.error("ASPA Tag: Could not save session.",t)}},t.prototype._restoreSessionOrInitNew=function(){try{var t=localStorage.getItem("aspa_session_".concat(this.config.integrationId));if(t){var e=JSON.parse(t),n=60*(this.config.sessionTTL||1)*60*1e3;if(e.sessionId&&Date.now()-e.lastActivity<n)return e.lastActivity=Date.now(),e;localStorage.removeItem("aspa_session_".concat(this.config.integrationId))}}catch(t){}return{sessionId:null,targetPhoneNumber:this.config.targetPhoneNumber,startTime:Date.now(),lastActivity:Date.now(),initialUrl:window.location.href,pageInteractions:{},adClickIds:{},navigation:{history:[],currentUrl:"",utmTracking:{allUtmParameters:[],latestValues:{},categorized:{sources:[],mediums:[],campaigns:[]}}}}},t.prototype._getSanitizedUrl=function(t){try{return new URL(t).origin+new URL(t).pathname}catch(e){return t.split("?")[0].split("#")[0]}},t.prototype._cleanupOldSessions=function(){try{for(var t="aspa_session_".concat(this.config.integrationId),e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);n&&n.startsWith("aspa_session_")&&n!==t&&localStorage.removeItem(n)}}catch(t){console.error("ASPA Tag: Error cleaning up old sessions.",t)}},t.prototype.validateConfig=function(){if(!this.config.integrationId||!this.config.targetPhoneNumber)throw new Error("ASPA Tag: integrationId and targetPhoneNumber are required.")},t.instance=null,t.AD_CLICK_IDENTIFIERS=["gclid","fbclid","msclkid","ttclid"],t.UTM_PARAMETERS=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],t.UTM_CATEGORIES={utm_source:"source",utm_medium:"medium",utm_campaign:"campaign",utm_term:"term",utm_content:"content"},t}();e.AspaTag=o,o.initialize()}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return function(){var t=r;Object.defineProperty(t,"__esModule",{value:!0}),n(884).AspaTag.initialize()}(),r}()}));
//# sourceMappingURL=aspa-tag.min.js.map
