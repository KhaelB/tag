!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ASPA=e():t.ASPA=e()}(this,(function(){return function(){"use strict";var t={635:function(t,e,r){r.r(e),r.d(e,{__addDisposableResource:function(){return R},__assign:function(){return i},__asyncDelegator:function(){return O},__asyncGenerator:function(){return A},__asyncValues:function(){return I},__await:function(){return P},__awaiter:function(){return h},__classPrivateFieldGet:function(){return x},__classPrivateFieldIn:function(){return N},__classPrivateFieldSet:function(){return C},__createBinding:function(){return y},__decorate:function(){return s},__disposeResources:function(){return L},__esDecorate:function(){return u},__exportStar:function(){return v},__extends:function(){return o},__generator:function(){return _},__importDefault:function(){return k},__importStar:function(){return D},__makeTemplateObject:function(){return T},__metadata:function(){return d},__param:function(){return c},__propKey:function(){return f},__read:function(){return m},__rest:function(){return a},__rewriteRelativeImportExtension:function(){return F},__runInitializers:function(){return l},__setFunctionName:function(){return p},__spread:function(){return w},__spreadArray:function(){return S},__spreadArrays:function(){return b},__values:function(){return g}});var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};function a(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function s(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function c(t,e){return function(r,n){e(r,n,t)}}function u(t,e,r,n,o,i){function a(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var s,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!e&&t?n.static?t:t.prototype:null,f=e||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),p=!1,d=r.length-1;d>=0;d--){var h={};for(var _ in n)h[_]="access"===_?{}:n[_];for(var _ in n.access)h.access[_]=n.access[_];h.addInitializer=function(t){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(t||null))};var y=(0,r[d])("accessor"===c?{get:f.get,set:f.set}:f[u],h);if("accessor"===c){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(s=a(y.get))&&(f.get=s),(s=a(y.set))&&(f.set=s),(s=a(y.init))&&o.unshift(s)}else(s=a(y))&&("field"===c?o.unshift(s):f[u]=s)}l&&Object.defineProperty(l,n.name,f),p=!0}function l(t,e,r){for(var n=arguments.length>2,o=0;o<e.length;o++)r=n?e[o].call(t,r):e[o].call(t);return n?r:void 0}function f(t){return"symbol"==typeof t?t:"".concat(t)}function p(t,e,r){return"symbol"==typeof e&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function d(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))}function _(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var y=Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function v(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||y(e,t,r)}function g(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function w(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}function b(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function S(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function P(t){return this instanceof P?(this.v=t,this):new P(t)}function A(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",(function(t){return function(e){return Promise.resolve(e).then(t,u)}})),n[Symbol.asyncIterator]=function(){return this},n;function a(t,e){o[t]&&(n[t]=function(e){return new Promise((function(r,n){i.push([t,e,r,n])>1||s(t,e)}))},e&&(n[t]=e(n[t])))}function s(t,e){try{(r=o[t](e)).value instanceof P?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(t){l(i[0][3],t)}var r}function c(t){s("next",t)}function u(t){s("throw",t)}function l(t,e){t(e),i.shift(),i.length&&s(i[0][0],i[0][1])}}function O(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:P(t[n](e)),done:!1}:o?o(e):e}:o}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=g(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,o,(e=t[r](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},j=function(t){return j=Object.getOwnPropertyNames||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[e.length]=r);return e},j(t)};function D(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r=j(t),n=0;n<r.length;n++)"default"!==r[n]&&y(e,t,r[n]);return E(e,t),e}function k(t){return t&&t.__esModule?t:{default:t}}function x(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function C(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r}function N(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)}function R(t,e,r){if(null!=e){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object expected.");var n,o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],r&&(o=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(t){return Promise.reject(t)}}),t.stack.push({value:e,dispose:n,async:r})}else r&&t.stack.push({async:!0});return e}var U="function"==typeof SuppressedError?SuppressedError:function(t,e,r){var n=new Error(r);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};function L(t){function e(e){t.error=t.hasError?new U(e,t.error,"An error was suppressed during disposal."):e,t.hasError=!0}var r,n=0;return function o(){for(;r=t.stack.pop();)try{if(!r.async&&1===n)return n=0,t.stack.push(r),Promise.resolve().then(o);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(o,(function(t){return e(t),o()}))}else n|=1}catch(t){e(t)}if(1===n)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}function F(t,e){return"string"==typeof t&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(t,r,n,o,i){return r?e?".jsx":".js":!n||o&&i?n+o+"."+i.toLowerCase()+"js":t})):t}e.default={__extends:o,__assign:i,__rest:a,__decorate:s,__param:c,__esDecorate:u,__runInitializers:l,__propKey:f,__setFunctionName:p,__metadata:d,__awaiter:h,__generator:_,__createBinding:y,__exportStar:v,__values:g,__read:m,__spread:w,__spreadArrays:b,__spreadArray:S,__await:P,__asyncGenerator:A,__asyncDelegator:O,__asyncValues:I,__makeTemplateObject:T,__importStar:D,__importDefault:k,__classPrivateFieldGet:x,__classPrivateFieldSet:C,__classPrivateFieldIn:N,__addDisposableResource:R,__disposeResources:L,__rewriteRelativeImportExtension:F}},884:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.AspaTag=void 0;var n=r(635),o=function(){function t(t){this.canvas=null,this._mutationObserver=null,this.config=t,this.validateConfig(),this._cleanupOldSessions(),this.sessionData=this._restoreSessionOrInitNew();try{this.canvas=document.createElement("canvas"),this.canvas.width=100,this.canvas.height=100}catch(t){this.canvas=null,console.error("ASPA Tag: Canvas for fingerprinting could not be created.")}this._initializeGlobalAPI(),this._setupNavigationTracking(),this._setupInteractionListeners(),this._setupTriggers(),this._handleNavigation(!0)}return t.initialize=function(){window.ASPA_PERSONALIZATION&&!t.instance&&(t.instance=new t(window.ASPA_PERSONALIZATION))},t.prototype.openWhatsApp=function(t){return n.__awaiter(this,void 0,void 0,(function(){var e,r,o,i;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this._updateLastPageDuration(),[4,this._emitSessionEvent(t)];case 1:return e=n.sent(),r=e.message||this.config.message||"Hello!",o="https://wa.me/".concat(this.config.targetPhoneNumber,"?text=").concat(encodeURIComponent(r)),window.open(o,"_blank"),[3,3];case 2:return i=n.sent(),console.error("ASPA Tag: Error opening WhatsApp:",i),[3,3];case 3:return[2]}}))}))},t.prototype._initializeGlobalAPI=function(){window.ASPA={openWhatsApp:this.openWhatsApp.bind(this)}},t.prototype._emitSessionEvent=function(t){return n.__awaiter(this,void 0,void 0,(function(){var e,r,o,i,a,s,c;return n.__generator(this,(function(u){switch(u.label){case 0:return this.sessionData.lastActivity=Date.now(),e=this.sessionData,[4,this._getFingerprint()];case 1:e.fingerprint=u.sent(),this.sessionData.cookies=this._getTrackedCookies(),this._saveSession();try{r=JSON.stringify(n.__assign(n.__assign({},this.sessionData),t?{formData:t}:{}))}catch(t){console.error("ASPA Tag: Error serializing session data:",t),r=JSON.stringify(this.sessionData)}u.label=2;case 2:return u.trys.push([2,7,,8]),"/"===(o=this.config.backendUrl).charAt(o.length-1)&&(o=o.slice(0,-1)),i="".concat(o,"/recordSession/").concat(this.config.integrationId),[4,fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:r,keepalive:!0})];case 3:return(a=u.sent()).ok?[3,5]:[4,a.json().catch((function(){return null}))];case 4:throw s=u.sent(),new Error((null==s?void 0:s.message)||"HTTP error! status: ".concat(a.status));case 5:return[4,a.json()];case 6:return[2,u.sent()];case 7:return c=u.sent(),console.error("ASPA Tag: Failed to emit session event.",c),[2,{sessionId:this.sessionData.sessionId,message:"Error: Could not connect to the server.",timestamp:(new Date).toISOString()}];case 8:return[2]}}))}))},t.prototype._setupNavigationTracking=function(){var t=this,e=history.pushState,r=history.replaceState;history.pushState=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];e.apply(history,r),t._handleNavigation()},history.replaceState=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r.apply(history,e),t._handleNavigation()},window.addEventListener("popstate",(function(){return t._handleNavigation()})),window.addEventListener("beforeunload",(function(){t._updateLastPageDuration(),t._saveSession()}))},t.prototype._setupInteractionListeners=function(){var t=this;document.addEventListener("click",(function(e){var r=t._getCurrentPageInteractions();if(r){var n=t._generateSelector(e.target);n&&r.clicks.push({target:n,timestamp:Date.now()})}}),{capture:!0,passive:!0});var e=null;window.addEventListener("scroll",(function(){e&&window.clearTimeout(e),e=window.setTimeout((function(){var e=t._getCurrentPageInteractions();if(e){var r=document.documentElement.scrollHeight-window.innerHeight;if(!(r<=0)){var n=Math.round(window.scrollY/r*100);n>e.scrollDepth&&(e.scrollDepth=n)}}}),150)}),{capture:!0,passive:!0})},t.prototype._setupTriggers=function(){var t=this,e=this.config.triggers;if(e){var r=function(){var r,n;if(null===(r=e.clickSelectors)||void 0===r?void 0:r.length){var o=e.clickSelectors.join(",");document.querySelectorAll(o).forEach((function(e){e.hasAttribute("data-aspa-click-bound")||(e.addEventListener("click",t._handleClick.bind(t),{capture:!0}),e.setAttribute("data-aspa-click-bound","true"))}))}(null===(n=e.formSelectors)||void 0===n?void 0:n.length)&&(o=e.formSelectors.join(","),document.querySelectorAll(o).forEach((function(e){e.hasAttribute("data-aspa-form-bound")||(e.addEventListener("submit",t._handleFormSubmit.bind(t),{capture:!0}),e.setAttribute("data-aspa-form-bound","true"))})))};r();var n=new MutationObserver((function(t){var e=!1;t.forEach((function(t){t.addedNodes.length>0&&(e=!0),"attributes"!==t.type||"class"!==t.attributeName&&"id"!==t.attributeName||(e=!0)})),e&&r()}));n.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","id"]}),this._mutationObserver=n}},t.prototype._handleClick=function(t){t.preventDefault(),t.stopPropagation(),this.openWhatsApp()},t.prototype._handleFormSubmit=function(t){this.openWhatsApp()},t.prototype._handleNavigation=function(t){void 0===t&&(t=!1);var e=window.location.href,r=this.sessionData.navigation.history.at(-1);if(t||e!==(null==r?void 0:r.url)){this._updateLastPageDuration(),this._trackUTMParameters(),this._trackAdClickIds();var o=this._getPageMetadata();this.sessionData.navigation.currentUrl=e,this.sessionData.navigation.history.push(n.__assign({url:e,referrer:t?document.referrer:(null==r?void 0:r.url)||"",timestamp:Date.now()},o));var i=this._getSanitizedUrl(e);this.sessionData.pageInteractions[i]||(this.sessionData.pageInteractions[i]={clicks:[],scrollDepth:0}),this._saveSession()}},t.prototype._getPageMetadata=function(){var t,e,r=Array.from(document.querySelectorAll("a")).map((function(t){return t.href})).filter((function(t){return t.startsWith("http")}));return{title:document.title,h1:(null===(e=null===(t=document.querySelector("h1"))||void 0===t?void 0:t.textContent)||void 0===e?void 0:e.trim())||null,hrefs:r}},t.prototype._updateLastPageDuration=function(){var t=this.sessionData.navigation.history.at(-1);t&&!t.duration&&(t.duration=Date.now()-t.timestamp)},t.prototype._trackAdClickIds=function(){var e,r;try{var o=new URLSearchParams(window.location.search);try{for(var i=n.__values(t.AD_CLICK_IDENTIFIERS),a=i.next();!a.done;a=i.next()){var s=a.value,c=o.get(s);c&&!this.sessionData.adClickIds[s]&&(this.sessionData.adClickIds[s]=c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}catch(t){console.error("ASPA Tag: Error tracking Ad Click IDs.",t)}},t.prototype._trackUTMParameters=function(){var e,r;try{var o=new URLSearchParams(window.location.search);try{for(var i=n.__values(t.UTM_PARAMETERS),a=i.next();!a.done;a=i.next()){var s=a.value,c=o.get(s);c&&this._addUtmParameter(s,c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}catch(t){console.error("ASPA Tag: Error tracking UTM parameters.",t)}},t.prototype._addUtmParameter=function(e,r){var n=this.sessionData.navigation.utmTracking;if(!n.allUtmParameters.some((function(t){return t.name===e&&t.value===r}))){var o=t.UTM_CATEGORIES[e]||"other",i={name:e,value:r,timestamp:Date.now(),category:o};if(n.allUtmParameters.push(i),"other"!==o){var a="".concat(o,"s"),s=n.categorized[a];s&&!s.some((function(t){return t.value===r}))&&s.push(i)}}n.latestValues[e]=r},t.prototype._getCurrentPageInteractions=function(){var t=this._getSanitizedUrl(this.sessionData.navigation.currentUrl);return this.sessionData.pageInteractions[t]||null},t.prototype._generateSelector=function(t){if(!t||t.matches("input[type='password'], input[type='email']")||t.closest("[data-aspa-ignore]"))return null;if(t.id)return"#".concat(t.id);for(var e=[],r=t;r&&r.nodeType===Node.ELEMENT_NODE;){var n=r.nodeName.toLowerCase();if(r.className&&"string"==typeof r.className){var o=r.className.split(" ").filter((function(t){return t&&!/^[0-9]/.test(t)})).join(".");o&&(n+=".".concat(o))}e.unshift(n),r=r.parentElement}return e.slice(0,5).join(" > ")},t.prototype._getFingerprint=function(){return n.__awaiter(this,void 0,void 0,(function(){var t;return n.__generator(this,(function(e){switch(e.label){case 0:return t={userAgent:navigator.userAgent,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenResolution:"".concat(window.screen.width,"x").concat(window.screen.height)},[4,this._generateCanvasFingerprint()];case 1:return[2,(t.canvasFingerprint=e.sent(),t)]}}))}))},t.prototype._generateCanvasFingerprint=function(){return n.__awaiter(this,void 0,void 0,(function(){var t,e,r,o;return n.__generator(this,(function(n){if(!this.canvas)return[2,""];if(!(t=this.canvas.getContext("2d")))return[2,""];for(t.fillStyle="#25D366",t.font="14px Arial",t.textBaseline="top",t.fillText("ASPA_Tracker_Canvas",10,10),e=t.getImageData(0,0,100,100).data,r=0,o=0;o<e.length;o++)r=(r<<5)-r+e[o],r|=0;return[2,r.toString()]}))}))},t.prototype._getTrackedCookies=function(){var t=this.config.cookieAllowlist||["_ga","_gid","gclid","fbclid"],e={};try{document.cookie.split(";").forEach((function(r){var o=n.__read(r.trim().split("="),2),i=o[0],a=o[1];i&&a&&t.includes(i)&&(e[i]=decodeURIComponent(a))}))}catch(t){}return e},t.prototype._saveSession=function(){try{localStorage.setItem("aspa_session_".concat(this.config.integrationId),JSON.stringify(this.sessionData))}catch(t){console.error("ASPA Tag: Could not save session.",t)}},t.prototype._restoreSessionOrInitNew=function(){try{var t=localStorage.getItem("aspa_session_".concat(this.config.integrationId));if(t){var e=JSON.parse(t),r=60*(this.config.sessionTTL||1)*60*1e3;if(e.sessionId&&Date.now()-e.lastActivity<r)return e.lastActivity=Date.now(),e;localStorage.removeItem("aspa_session_".concat(this.config.integrationId))}}catch(t){}return{sessionId:null,targetPhoneNumber:this.config.targetPhoneNumber,startTime:Date.now(),lastActivity:Date.now(),initialUrl:window.location.href,pageInteractions:{},adClickIds:{},navigation:{history:[],currentUrl:"",utmTracking:{allUtmParameters:[],latestValues:{},categorized:{sources:[],mediums:[],campaigns:[]}}}}},t.prototype._getSanitizedUrl=function(t){try{return new URL(t).origin+new URL(t).pathname}catch(e){return t.split("?")[0].split("#")[0]}},t.prototype._cleanupOldSessions=function(){try{for(var t="aspa_session_".concat(this.config.integrationId),e=localStorage.length-1;e>=0;e--){var r=localStorage.key(e);r&&r.startsWith("aspa_session_")&&r!==t&&localStorage.removeItem(r)}}catch(t){console.error("ASPA Tag: Error cleaning up old sessions.",t)}},t.prototype.validateConfig=function(){if(!this.config.integrationId||!this.config.targetPhoneNumber)throw new Error("ASPA Tag: integrationId and targetPhoneNumber are required.")},t.instance=null,t.AD_CLICK_IDENTIFIERS=["gclid","fbclid","msclkid","ttclid"],t.UTM_PARAMETERS=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],t.UTM_CATEGORIES={utm_source:"source",utm_medium:"medium",utm_campaign:"campaign",utm_term:"term",utm_content:"content"},t}();e.AspaTag=o,o.initialize()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return function(){var t=n;Object.defineProperty(t,"__esModule",{value:!0}),r(884).AspaTag.initialize()}(),n}()}));
//# sourceMappingURL=aspa-tag.min.js.map